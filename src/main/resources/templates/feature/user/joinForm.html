<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>술프링부트 - 회원가입</title>
    <link th:href="@{/css/user/joinForm.css}" rel="stylesheet">
</head>
<body>

<div th:replace="~{fragment/navbar-fragment :: navbarFragment}"></div>

<hr class="divider">

<div class="card">
    <h2 style="color: white; margin-bottom: 40px;">회원가입</h2>
    <form id="joinForm" th:action="@{/user/join}" th:object="${userJoinRequest}" method="post" class="info" onsubmit="return validateForm()">
        <!-- 이메일 입력란 -->
        <div class="input-container">
            <label for="email" style="color: white; margin-right: 10px; width: 140px;">이메일</label>
            <input type="email" class="input" th:field="*{email}" id="email" required>
        </div>
        <div class="button-code">
            <button id="sendCodeButton" class="code-button" type="button" onclick="sendAuthCode()">인증코드 보내기</button>
        </div>
        <div id="authSection" class="hidden">
            <!-- 인증 코드 입력란과 타이머 -->
            <div class="input-container">
                <label for="authCode" style="color: white; margin-right: 10px; width: 140px;">인증 코드</label>
                <input type="text" class="input" th:field="*{authCode}" id="authCode" required>
                <span id="timer" style="color: white; margin-left: 10px;">03:00</span>
            </div>
            <div class="button-code">
                <button class="code-button" type="button" onclick="verifyAuthCode()">인증 확인</button>
                <button id="resendCodeButton" class="code-button hidden" type="button" onclick="resendAuthCode()">재발송</button>
            </div>
        </div>

        <div id="userDetailsSection" class="hidden">
            <!-- 비밀번호 입력란 -->
            <div class="input-container">
                <label for="password" style="color: white; margin-right: 10px; width: 140px;">비밀번호</label>
                <input type="password" class="input" th:field="*{password}" id="password" required>
            </div>
            <div class="input-container">
                <label for="passwordCheck" style="color: white; margin-right: 10px; width: 140px;">비밀번호 확인</label>
                <input type="password" class="input" th:field="*{passwordCheck}" id="passwordCheck" required>
            </div>
        </div>

        <div class="button-container">
            <button id="submitButton" class="button hidden" type="submit">회원가입</button>
        </div>
    </form>

    <script>
        function validateForm() {
            // 콘솔에 값을 출력하여 확인
            console.log("Before submit - Email:", document.getElementById("email").value);
            console.log("Before submit - AuthCode:", document.getElementById("authCode").value);
            console.log("Before submit - Password:", document.getElementById("password").value);
            console.log("Before submit - PasswordCheck:", document.getElementById("passwordCheck").value);

            return true; // 폼이 정상적으로 제출되도록 설정
        }
    </script>
</div>

<script th:src="@{/js/joinForm.js}"></script>
</body>
</html>